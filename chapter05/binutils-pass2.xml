<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<section xmlns="http://docbook.org/ns/docbook"
         xml:id="ch-tools-binutils-pass2" role="wrap">
<title>Binutils-&binutils-version; - Pass 2</title>
<?dbhtml filename="binutils-pass2.html"?>

<indexterm zone="ch-tools-binutils-pass2">
<primary sortas="a-Binutils">Binutils</primary>
<secondary>tools, pass 2</secondary></indexterm>

<section role="package"><title/>

<segmentedlist>
<segtitle>&buildtime;</segtitle>
<segtitle>&diskspace;</segtitle>
<seglistitem><seg>1.5 SBU</seg><seg>108 MB</seg></seglistitem>
</segmentedlist>

</section>

<section role="installation">
<title>Re-installation of Binutils</title>

<para>Create a separate build directory again:</para>

<screen><userinput>mkdir ../binutils-build
cd ../binutils-build</userinput></screen>

<para>Now prepare Binutils for compilation:</para>

<screen><userinput>../binutils-&binutils-version;/configure --prefix=/tools \
    --enable-shared --with-lib-path=/tools/lib</userinput></screen>

<para>The meaning of the new configure option:</para>

<variablelist>
<varlistentry>
<term><parameter>--with-lib-path=/tools/lib</parameter></term>
<listitem><para>This tells the configure script to specify the library search path 
during the compilation of Binutils, resulting in <parameter>/tools/lib</parameter>
to be passed to the linker. This prevents the linker from searching through library 
directories on the host.</para></listitem>
</varlistentry>
</variablelist>

<para>Before starting to build Binutils, remember to unset any environment
variables that override the default optimization flags.</para>

<para>Compile the package:</para>

<screen><userinput>make</userinput></screen>

<para>Compilation is now complete. As discussed earlier, running the test suite
isn't mandatory for the temporary tools here in this chapter. If you do want to
run the Binutils test suite though, the following command will do so:</para>

<screen><userinput>make -k check</userinput></screen>

<para>Except for a few known failures, the binutils tests should all pass. The
exceptions to this rule are as follows:</para>

<screen><computeroutput>* 5 FAIL (unexpected failure) for visibility
* 1 FAIL for selective4
* 1 FAIL for selective5</computeroutput></screen>

<!--

<para>There should be no unexpected failures here, expected failures are fine.
Unfortunately, there is no easy way to view the test results summary like there
was for the GCC package. However, if a failure occurs here, it should be easy
to spot. The output shown will contain something like:</para>

<blockquote><screen><computeroutput>make[1]: *** [check-binutils] Error 2</computeroutput></screen></blockquote>

-->

<para>And install the package:</para>

<screen><userinput>make install</userinput></screen>

<para>Now prepare the linker for the <quote>Re-adjusting</quote> phase in the next
chapter:</para>

<screen><userinput>make -C ld clean
make -C ld LIB_PATH=/usr/lib:/lib</userinput></screen>


<warning><para><emphasis>Do not yet remove</emphasis> the Binutils source and
build directories. You will need these directories again in the next chapter
in the state they are in now.</para></warning>


</section>

<section role="content"><title/>
<para>The details on this package are found in <xref linkend="contents-binutils"/>.</para>
</section>

</section>
